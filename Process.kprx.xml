<?xml version="1.0" encoding="utf-8"?>
<Process Type="SourceCode.Workflow.Design.DefaultProcess" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" Version="4">
  <References>
    <AssemblyReference>
      <Guid>01e155a1db0a40a3a7db1fad224c2e50</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System</ItemInclude>
      <AssemblyName>System</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>4bcb935587be49cfb702798c20fa7ab5</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Core</ItemInclude>
      <AssemblyName>System.Core</AssemblyName>
      <RequiredFramework>3.5</RequiredFramework>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>2bc78475df6c461da91e7c552ea6f166</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Xml.Linq</ItemInclude>
      <AssemblyName>System.Xml.Linq</AssemblyName>
      <RequiredFramework>3.5</RequiredFramework>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>57f7b619009c4296bcf295c66ace7446</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Drawing</ItemInclude>
      <AssemblyName>System.Drawing</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>61ff7b42ac644ca8b3eaa7ea3be2b52f</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Windows.Forms</ItemInclude>
      <AssemblyName>System.Windows.Forms</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>fa2abaa2de9d4ac08996954311414573</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Data</ItemInclude>
      <AssemblyName>System.Data</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>4afd11a0570e4092b3f7c3861fc214e2</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Xml</ItemInclude>
      <AssemblyName>System.Xml</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>50cdcb0e41344679b8e6ca227300ad66</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Design</ItemInclude>
      <AssemblyName>System.Design</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>31ee7f4885f74553b8d88a179c7d8981</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Web</ItemInclude>
      <AssemblyName>System.Web</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>52bd58ce2d4f498cb9db7f14746daf58</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Web.Services</ItemInclude>
      <AssemblyName>System.Web.Services</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>04b533a69dd140a1a0d8522c1cc56ca3</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Transactions</ItemInclude>
      <AssemblyName>System.Transactions</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>a886ae2371b4406aaa4733c36be19f98</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, ProcessorArchitecture=MSIL</ItemInclude>
      <AssemblyName>System.ServiceModel</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>276179fadb644e709607ac011a484c76</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Drawing.Design</ItemInclude>
      <AssemblyName>System.Drawing.Design</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>d9a0b354ad4544d3bc8a4321d48d93e7</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>KO, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</ItemInclude>
      <CopyLocal>0</CopyLocal>
      <AssemblyName>KO, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</AssemblyName>
      <Path>C:\Program Files\K2 blackpoint\bin\KO.dll</Path>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>cdfe55c4cfd64008974236f6e37ae23f</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</ItemInclude>
      <CopyLocal>0</CopyLocal>
      <AssemblyName>SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>0d3855880c1844ac884a8718f3e16369</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>SourceCode.ResolverFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</ItemInclude>
      <CopyLocal>0</CopyLocal>
      <AssemblyName>SourceCode.ResolverFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>493d95970ee8415caf1b2b437be36a24</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Workflow.ComponentModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL</ItemInclude>
      <AssemblyName>System.Workflow.ComponentModel</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>ae8e1e36b54a47eaa2fb40766a9b7040</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Workflow.Runtime, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL</ItemInclude>
      <AssemblyName>System.Workflow.Runtime</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>5931a942daaa4ed98935e33f9c7aa193</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>System.Workflow.Activities, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL</ItemInclude>
      <AssemblyName>System.Workflow.Activities</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>e86a8a0d086747a0ac75f62b1b4c6374</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>SourceCode.SmartObjects.Client, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</ItemInclude>
      <AssemblyName>SourceCode.SmartObjects.Client, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</AssemblyName>
    </AssemblyReference>
    <AssemblyReference>
      <Guid>9bdfe649311546e6b5a000d4d03df33e</Guid>
      <ItemName>Reference</ItemName>
      <ItemInclude>SourceCode.HostClientAPI, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</ItemInclude>
      <AssemblyName>SourceCode.HostClientAPI, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d</AssemblyName>
    </AssemblyReference>
  </References>
  <ExecutionLayers>
    <ExecutionLayer>
      <ExecutableItems>
        <MailEventItem Type="SourceCode.Workflow.Design.Mail.MailEventItem" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
          <Extender Type="SourceCode.Workflow.Design.WindowsWorkflowExtender" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <CodeFiles>
              <CodeFile>
                <Guid>0e526b262bc44c00b7240fed1c535bb4</Guid>
                <OriginalFileName>@safeitemname@.xoml</OriginalFileName>
                <Primary>1</Primary>
                <Content><![CDATA[<ns0:WorkflowContext xmlns:ns0="clr-namespace:SourceCode.Workflow.Common.Extenders;Assembly=SourceCode.Workflow.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d" x:Class="ExtenderProject_356ce97d8118461788790a9277472edc.EventItem_047f6ab6d76040648ac74668e5a5ad9b" x:Name="EventItem_047f6ab6d76040648ac74668e5a5ad9b" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WorkflowContext.LockedActivities>
		<x:Array Type="{x:Type System.String}">
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SetProperties</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">Attachment</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">AttachmentPresent</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">AddAttachment</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">NaAttachment</ns1:String>
			<ns1:String xmlns:ns1="clr-namespace:System;Assembly=mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">SendMail</ns1:String>
		</x:Array>
	</ns0:WorkflowContext.LockedActivities>
	<CodeActivity x:Name="SetProperties" ExecuteCode="SetProperties_ExecuteCode" />
	<IfElseActivity x:Name="Attachment">
		<IfElseBranchActivity x:Name="AttachmentPresent">
			<IfElseBranchActivity.Condition>
				<CodeCondition Condition="HasAttachment" />
			</IfElseBranchActivity.Condition>
			<CodeActivity x:Name="AddAttachment" ExecuteCode="AddAttachment_ExecuteCode" />
		</IfElseBranchActivity>
		<IfElseBranchActivity x:Name="NaAttachment" />
	</IfElseActivity>
	<CodeActivity x:Name="SendMail" ExecuteCode="SendMail_ExecuteCode" />
</ns0:WorkflowContext>]]></Content>
              </CodeFile>
              <CodeFile>
                <Guid>bae39156cd0e434e966dcaadbab1e733</Guid>
                <OriginalFileName>@safeitemname@.xoml.cs</OriginalFileName>
                <Content><![CDATA[using System;
using System.Net.Mail;
using System.Configuration;
using System.Workflow.Activities;
using System.ComponentModel;
using SourceCode.Workflow.Common.Extenders;
using System.Xml;
using System.Text;
 
using HOSTCONTEXT = Project_356ce97d8118461788790a9277472edc.EventItemContext_047f6ab6d76040648ac74668e5a5ad9b;

namespace ExtenderProject_356ce97d8118461788790a9277472edc
{
    public partial class EventItem_047f6ab6d76040648ac74668e5a5ad9b : IWorkflowContext<HOSTCONTEXT>
    {

        #region Members

        private HOSTCONTEXT _k2;

        #endregion

        #region Properties

        [EditorBrowsable(EditorBrowsableState.Never)]
        [DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]

        private MailMessage _emailmessage = null;
        private MailMessage EmailMessage
        {
            set
            {
                _emailmessage = value;
            }
            get
            {
                if (_emailmessage == null)
                {
                    _emailmessage = new MailMessage();
                }
                return _emailmessage;
            }
        }
        #endregion

        #region Code Activities

        private void HasAttachment(object sender, ConditionalEventArgs e)
        {
            e.Result = bool.Parse(K2.Configuration.HasAttachment);
        }

        private void SetProperties_ExecuteCode(object sender, EventArgs e)
        {
            this.EmailMessage.From = new MailAddress(K2.Configuration.From);

            if (bool.Parse(K2.Configuration.ToSpecify))
            {
                if (!string.IsNullOrEmpty(K2.Configuration.To))
                {
                    string[] arrto = K2.Configuration.To.Split(';');
                    foreach (string to in arrto)
                    {
                        if (string.IsNullOrEmpty(to))
                        {
                            throw new ArgumentException("The email address, Null or Empty, does not meet the requirements.");
                        }

                        try
                        {
                            this.EmailMessage.To.Add(new MailAddress(to));
                        }
                        catch
                        {
                            throw new FormatException("The email address : " + to + ", is invalid.");
                        }
                    }
                }
            }

            if (!string.IsNullOrEmpty(K2.Configuration.Cc))
            {
                string[] arrcc = K2.Configuration.Cc.Split(';');
                foreach (string cc in arrcc)
                {
                    if (string.IsNullOrEmpty(cc))
                    {
                        throw new ArgumentException("The email address, Null or Empty, does not meet the requirements.");
                    }

                    try
                    {
                        this.EmailMessage.CC.Add(new MailAddress(cc));
                    }
                    catch
                    {
                        throw new FormatException("The email address : " + cc + ", is invalid.");
                    }
                }
            }

            if (!string.IsNullOrEmpty(K2.Configuration.Bcc))
            {
                string[] arrbcc = K2.Configuration.Bcc.Split(';');
                foreach (string bcc in arrbcc)
                {
                    if (string.IsNullOrEmpty(bcc))
                    {
                        throw new ArgumentException("The email address, Null or Empty, does not meet the requirements.");
                    }

                    try
                    {
                        this.EmailMessage.Bcc.Add(new MailAddress(bcc));
                    }
                    catch
                    {
                        throw new FormatException("The email address : " + bcc + ", is invalid.");
                    }
                }
            }

            // CHECK FLAG TO INCLUDE DESTINATION USER(S)
            if (bool.Parse(K2.Configuration.ToDestinationUser))
            {
                // IF SINGLEINSTANCE
                if (K2.ActivityInstanceDestination.ActivityInstance.SingleInstance)
                {
                    foreach (SourceCode.KO.User user in K2.ActivityInstanceDestination.ActivityInstance.Destinations)
                    {
                        this.EmailMessage.To.Add(user.Email);
                    }
                }
                else
                {
                    // IF NOT SINGLEINSTANCE USE USER EMAIL
                    if (K2.ActivityInstanceDestination.User == null)
                    {
                        throw new Exception("Activity instance destination not available.");
                    }
                    this.EmailMessage.To.Add(K2.ActivityInstanceDestination.User.Email.ToString());
                }
            }

            if (bool.Parse(K2.Configuration.ToOriginator))
            {
                this.EmailMessage.To.Add(K2.ProcessInstance.Originator.Email.ToString());
            }

            this.EmailMessage.Subject = K2.Configuration.Subject;

            this.EmailMessage.Body = K2.Configuration.Body;

            this.EmailMessage.IsBodyHtml = bool.Parse(K2.Configuration.HTMLEmail);

            switch (K2.Configuration.Importance)
            {
                case "0":
                    this.EmailMessage.Priority = MailPriority.Normal;
                    break;
                case "1":
                    this.EmailMessage.Priority = MailPriority.Low;
                    break;
                case "2":
                    this.EmailMessage.Priority = MailPriority.High;
                    break;
            }
        }

        private void AddAttachment_ExecuteCode(object sender, EventArgs e)
        {

            XmlDocument MyXml = new XmlDocument();

            MyXml.LoadXml(K2.Configuration.Attachments);

            foreach (XmlElement attachmentitem in MyXml.DocumentElement.SelectSingleNode("//mailevent/attachments").ChildNodes)
            {
                string location = string.Empty;
                string filename = string.Empty;
                string content = string.Empty;
                string fieldname = string.Empty;
                string xmlfieldxpath = string.Empty;

                string xmlfilenamexpath = string.Empty;
                string xmlfilenamefield = string.Empty;
                string xmlfilenamefieldscope = string.Empty;
                string xmlfilecontentxpath = string.Empty;
                string xmlfilecontentfield = string.Empty;
                string xmlfilecontentfieldscope = string.Empty;

                bool isencodingtext = false;
                bool isxmlfield = false;
                bool isipattachments = false;
                bool isstringfield = false;
                bool issofield = false;
                bool isfileondisk = false;
                bool issolistfield = true;

                if (attachmentitem.SelectSingleNode("location").FirstChild != null)
                {
                    location = attachmentitem.SelectSingleNode("location").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("filename").FirstChild != null)
                {
                    filename = attachmentitem.SelectSingleNode("filename").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("content").FirstChild != null)
                {
                    content = attachmentitem.SelectSingleNode("content").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("fieldname").FirstChild != null)
                {
                    fieldname = attachmentitem.SelectSingleNode("fieldname").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("isfileondisk").FirstChild != null)
                {
                    isfileondisk = bool.Parse(attachmentitem.SelectSingleNode("isfileondisk").FirstChild.InnerText);
                }
                if (attachmentitem.SelectSingleNode("isencodingtext").FirstChild != null)
                {
                    isencodingtext = bool.Parse(attachmentitem.SelectSingleNode("isencodingtext").FirstChild.InnerText);
                }
                if (attachmentitem.SelectSingleNode("isxmlfield").FirstChild != null)
                {
                    isxmlfield = bool.Parse(attachmentitem.SelectSingleNode("isxmlfield").FirstChild.InnerText);
                }
                if (attachmentitem.SelectSingleNode("isipattachments").FirstChild != null)
                {
                    isipattachments = bool.Parse(attachmentitem.SelectSingleNode("isipattachments").FirstChild.InnerText);
                }
                if (attachmentitem.SelectSingleNode("isstringfield").FirstChild != null)
                {
                    isstringfield = bool.Parse(attachmentitem.SelectSingleNode("isstringfield").FirstChild.InnerText);
                }
                if (attachmentitem.SelectSingleNode("issofield").FirstChild != null)
                {
                    issofield = bool.Parse(attachmentitem.SelectSingleNode("issofield").FirstChild.InnerText);
                }
                if (attachmentitem.SelectSingleNode("issolistfield").FirstChild != null)
                {
                    issolistfield = bool.Parse(attachmentitem.SelectSingleNode("issolistfield").FirstChild.InnerText);
                }
                if (attachmentitem.SelectSingleNode("xmlfieldxpath").FirstChild != null)
                {
                    xmlfieldxpath = attachmentitem.SelectSingleNode("xmlfieldxpath").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("xmlfilenamexpath").FirstChild != null)
                {
                    xmlfilenamexpath = attachmentitem.SelectSingleNode("xmlfilenamexpath").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("xmlfilenamefield").FirstChild != null)
                {
                    xmlfilenamefield = attachmentitem.SelectSingleNode("xmlfilenamefield").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("xmlfilenamefieldscope").FirstChild != null)
                {
                    xmlfilenamefieldscope = attachmentitem.SelectSingleNode("xmlfilenamefieldscope").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("xmlfilecontentxpath").FirstChild != null)
                {
                    xmlfilecontentxpath = attachmentitem.SelectSingleNode("xmlfilecontentxpath").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("xmlfilecontentfield").FirstChild != null)
                {
                    xmlfilecontentfield = attachmentitem.SelectSingleNode("xmlfilecontentfield").FirstChild.InnerText;
                }
                if (attachmentitem.SelectSingleNode("xmlfilecontentfieldscope").FirstChild != null)
                {
                    xmlfilecontentfieldscope = attachmentitem.SelectSingleNode("xmlfilecontentfieldscope").FirstChild.InnerText;
                }

                if (isfileondisk)
                {
                    this.EmailMessage.Attachments.Add(new Attachment(System.IO.Path.Combine(location, filename)));
                }
                else if (isxmlfield)
                {
                    //IP attachments : <?mso-infoPath-file-attachment-present?>
                    if (isipattachments)
                    {
                        SourceCode.Workflow.Common.SharePoint.Document.InfoPath.Attachments ipAttachments = new
                        SourceCode.Workflow.Common.SharePoint.Document.InfoPath.Attachments(content, xmlfieldxpath);

                        byte[] xmlfileData = ipAttachments[0].File;

                        string xmlfileName = ipAttachments[0].FileName;

                        if (string.IsNullOrEmpty(xmlfileName))
                        {
                            xmlfileName = filename;
                        }

                        System.IO.MemoryStream ms = new System.IO.MemoryStream(xmlfileData);

                        this.EmailMessage.Attachments.Add(new Attachment(ms, xmlfileName));
                    }
                    //Base64
                    else if (xmlfieldxpath.Length > 1)
                    {
                        //Xml Repeating Node
                        if ((xmlfilenamexpath.Length > 1) && (xmlfilecontentxpath.Length > 1))
                        {
                            XmlDocument xmlFileNameCollection = new XmlDocument();

                            XmlDocument xmlFileContentCollection = new XmlDocument();

                            if (xmlfilenamefieldscope.ToUpper() == "PROCESS")
                            {
                                xmlFileNameCollection.LoadXml(K2.ProcessInstance.XmlFields[xmlfilenamefield].Value);
                            }
                            else if (xmlfilenamefieldscope.ToUpper() == "ACTIVITY")
                            {
                                xmlFileNameCollection.LoadXml(K2.ActivityInstanceDestination.XmlFields[xmlfilenamefield].Value);
                            }

                            if (xmlfilecontentfieldscope.ToUpper() == "PROCESS")
                            {
                                xmlFileContentCollection.LoadXml(K2.ProcessInstance.XmlFields[xmlfilecontentfield].Value);
                            }
                            else if (xmlfilenamefieldscope.ToUpper() == "ACTIVITY")
                            {
                                xmlFileContentCollection.LoadXml(K2.ActivityInstanceDestination.XmlFields[xmlfilecontentfield].Value);
                            }

                            XmlNodeList xmlFileNameList = xmlFileNameCollection.SelectNodes(xmlfilenamexpath);

                            XmlNodeList xmlFileContentList = xmlFileContentCollection.SelectNodes(xmlfilecontentxpath);

                            for (Int32 I = 0; I < xmlFileContentList.Count; I++)
                            {
                                System.IO.MemoryStream ms = new System.IO.MemoryStream(System.Convert.FromBase64String(xmlFileContentList[I].InnerText));

                                this.EmailMessage.Attachments.Add(new Attachment(ms, xmlFileNameList[I].InnerText));
                            }
                        }
                        //Xml Node Content
                        else
                        {
                            System.IO.MemoryStream ms = new System.IO.MemoryStream(System.Convert.FromBase64String(content));

                            this.EmailMessage.Attachments.Add(new Attachment(ms, filename));
                        }
                    }
                    // Text
                    else
                    {
                        byte[] buffer = Encoding.UTF8.GetBytes(content);

                        System.IO.MemoryStream ms = new System.IO.MemoryStream(buffer);

                        this.EmailMessage.Attachments.Add(new Attachment(ms, filename));
                    }
                }
                else
                {
                    if (isstringfield)
                    {
                        //Base64
                        if ((!isencodingtext) || (issofield) || (issolistfield))
                        {
                            System.IO.MemoryStream ms = new System.IO.MemoryStream(System.Convert.FromBase64String(content));

                            this.EmailMessage.Attachments.Add(new Attachment(ms, filename));
                        }
                        // Text
                        else
                        {
                            byte[] buffer = Encoding.UTF8.GetBytes(content);

                            System.IO.MemoryStream ms = new System.IO.MemoryStream(buffer);

                            this.EmailMessage.Attachments.Add(new Attachment(ms, filename));
                        }
                    }
                    // Binary 2 Base64
                    else
                    {
                        System.IO.MemoryStream ms = new System.IO.MemoryStream(System.Convert.FromBase64String(content));

                        this.EmailMessage.Attachments.Add(new Attachment(ms, filename));
                    }
                }

            }
        }

        private void SendMail_ExecuteCode(object sender, EventArgs e)
        {
            SmtpClient client = new SmtpClient();

            if (K2.Configuration.SMTPServer.IndexOf(":") == -1)
            {
                client.Host = K2.Configuration.SMTPServer;
            }
            else
            {
                string[] connection = K2.Configuration.SMTPServer.Split(new Char[] {':' });

                Int32 I = 0;

                if (string.IsNullOrEmpty(connection[0]) || string.IsNullOrEmpty(connection[1]))
                {
                    throw new Exception("Invalid SMTP Server / Port arguments supplied.");
                }

                // PORT 2ND PARM ONLY!
                if (Int32.TryParse(connection[1], out I))
                {
                    client.Host = connection[0];
                    client.Port = Int32.Parse(connection[1]);
                }
                else
                {
                    throw new Exception("Invalid SMTP Server / Port arguments supplied.");
                }
            }

            client.Send(this.EmailMessage);
            client = null;

            if (_emailmessage != null)
            {
                _emailmessage.Dispose();
            }
            _emailmessage = null;
        }

        #endregion

        #region IWorkflowContext<HOSTCONTEXT> Members

        public Project_356ce97d8118461788790a9277472edc.EventItemContext_047f6ab6d76040648ac74668e5a5ad9b K2
        {
            get
            {
                return _k2;
            }
            set
            {
                _k2 = value;
            }
        }

        #endregion

    }
}
]]></Content>
              </CodeFile>
            </CodeFiles>
            <Guid>047f6ab6d76040648ac74668e5a5ad9b</Guid>
            <MetaData/>
            <Language>CSharp</Language>
          </Extender>
          <SMTPServer Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Parts>
              <ArtifactLibraryFieldPart Type="SourceCode.Workflow.Design.ArtifactLibraryFieldPart" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
                <Guid>d98364fc780e45dcaad388ec16fceead</Guid>
                <FieldName>Mail Server</FieldName>
              </ArtifactLibraryFieldPart>
            </Parts>
            <Guid>c33eddbfed4e4bf6b75a690d8e9223ec</Guid>
          </SMTPServer>
          <From Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Parts>
              <ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
                <Guid>22ace33bf5dd4aa795536cc1f8d9ae09</Guid>
                <ValueType>System.String, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType>
                <Value><![CDATA[abc@123.com]]></Value>
              </ValueTypePart>
            </Parts>
            <Guid>d1ba165a02c84ceba7402d281c08ff00</Guid>
          </From>
          <Subject Type="SourceCode.Workflow.Authoring.K2Field" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Parts>
              <ValueTypePart Type="SourceCode.Workflow.Design.ValueTypePart" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
                <Guid>d5a837a21bde477788cbcc9a8bac379f</Guid>
                <ValueType>System.String, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ValueType>
                <Value><![CDATA[hello world]]></Value>
              </ValueTypePart>
            </Parts>
            <Guid>3e2020dcdd6f43bfb6642c101f9cc479</Guid>
          </Subject>
          <Guid>69d1decfb6c9434abd8c3d038c8ddbb6</Guid>
          <MetaData/>
          <Parent ref="3f8acd5e-e28b-4cdb-a158-457334317351&#13;"/>
          <ToOriginator>1</ToOriginator>
          <Importance>0</Importance>
          <Version>1</Version>
        </MailEventItem>
      </ExecutableItems>
      <Guid>5ed9b2e713994e4298da85d789211c0a</Guid>
      <Name>Default</Name>
      <Description>This represents the default execution layer for the process.</Description>
    </ExecutionLayer>
  </ExecutionLayers>
  <Lines>
    <Line Type="SourceCode.Workflow.Design.DefaultLine" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
      <WizardDefinition Type="SourceCode.Workflow.Design.DefaultLineWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <PropertyWizardDefinitions>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>1c5126c4ff374953a483f4c99577a0a5</Guid>
            <Name>{177a9dda-5805-4ae5-a880-fde470b84167}</Name>
            <RegisteredItem>Line General Property Wizard</RegisteredItem>
          </PropertyWizardDefinition>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleLineRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>87cbb8eb20c544f0bb525f0aed84958d</Guid>
            <Name>{301a39e8-ced8-4b6f-8d6c-7b4e627213bf}</Name>
            <RegisteredItem>E050F697-C765-4b55-A7BA-E9E0F05CBF32</RegisteredItem>
          </PropertyWizardDefinition>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>fa9472ea68894a3b9b2197bc21dcecf0</Guid>
            <Name>{6f6657c8-a4f1-4302-a924-4d392f49d2da}</Name>
            <RegisteredItem>Exception Rule</RegisteredItem>
          </PropertyWizardDefinition>
        </PropertyWizardDefinitions>
        <Guid>ee4cbae82dbe4b44acd6e74e814b98b6</Guid>
        <Name/>
        <Status>Executed</Status>
        <RegisteredItem>Default Line Wizard</RegisteredItem>
      </WizardDefinition>
      <Guid>20b66924e76347bea5fe477091359a23</Guid>
      <Name>DefaultLine</Name>
      <StartActivity>Start</StartActivity>
      <FinishActivity>DefaultActivity</FinishActivity>
    </Line>
  </Lines>
  <Activities>
    <Activity Type="SourceCode.Workflow.Design.DefaultActivity" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
      <Events>
        <Event Type="SourceCode.Workflow.Design.Mail.MailEvent" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
          <WizardDefinition Type="SourceCode.Workflow.Design.Mail.MailWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <PropertyWizardDefinitions>
              <PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
                <Guid>4689ccb6b61c4961870c81bf99636f8f</Guid>
                <Name>{60482781-7219-4781-a267-fb9378e213b8}</Name>
                <RegisteredItem>Event General Property Wizard</RegisteredItem>
              </PropertyWizardDefinition>
              <PropertyWizardDefinition Type="SourceCode.Workflow.Design.Mail.MailPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
                <Guid>9a81aeb967ea43f9bef5e71cd0bf6a92</Guid>
                <Name>{48361767-bb2a-429f-be9b-030838ee6886}</Name>
                <RegisteredItem>Mail Event Item Property Wizard</RegisteredItem>
              </PropertyWizardDefinition>
              <PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
                <Guid>cbca61e42e7045f383f4b6bb7fce9dd8</Guid>
                <Name>{713a39ea-4376-44d5-aa75-e1ec97d18527}</Name>
                <RegisteredItem>Exception Rule</RegisteredItem>
              </PropertyWizardDefinition>
            </PropertyWizardDefinitions>
            <Guid>153127e792b44a45856e81f646e9be64</Guid>
            <Name/>
            <Status>Executed</Status>
            <RegisteredItem>Mail Event Wizard</RegisteredItem>
          </WizardDefinition>
          <Guid>3f8acd5ee28b4cdba158457334317351</Guid>
          <Name>MailEvent</Name>
          <EventItemGuid>69d1decf-b6c9-434a-bd8c-3d038c8ddbb6</EventItemGuid>
        </Event>
      </Events>
      <WizardDefinition Type="SourceCode.Workflow.Design.DefaultActivityWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <PropertyWizardDefinitions>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>48c49fa293d14cc0825e9347d2247148</Guid>
            <Name>{b5cb32fb-e617-4954-a6a4-c1a5a3dd9346}</Name>
            <RegisteredItem>Activity General Property Wizard</RegisteredItem>
          </PropertyWizardDefinition>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimplePrecedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>fdf0ff2a9e85458ea27d7ce4726d5337</Guid>
            <Name>{65393e89-5fd3-46cb-aece-18bfc0a027ab}</Name>
            <RegisteredItem>192BEB05-2569-4e44-BFB4-7ED57C3EC768</RegisteredItem>
          </PropertyWizardDefinition>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleActivityStartRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>7555644d8d4a41fb833043787dbd0da7</Guid>
            <Name>{5a83b373-239c-4230-89aa-f6acd2b65cf1}</Name>
            <RegisteredItem>53BDF237-B878-4829-8A81-255E05CCBFA9</RegisteredItem>
          </PropertyWizardDefinition>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleDestinationRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>467c39c1423342c09e8102e45e5e8985</Guid>
            <Name>{587a1d9d-4f42-4b87-b8b7-45aef9d1058c}</Name>
            <RegisteredItem>AAE10A29-8F80-4934-9623-0A1C4FA4FD09</RegisteredItem>
          </PropertyWizardDefinition>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.SimpleRules.SimpleSucceedingRulePropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>722f39890b6e47d492e26b185eabe912</Guid>
            <Name>{01bbda34-6a99-409a-82f1-4b829f43f268}</Name>
            <RegisteredItem>D432E2E2-E5EC-476a-9647-B30702805FBF</RegisteredItem>
          </PropertyWizardDefinition>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>bddec17cbba446d8bf4a56c4d59c1ccc</Guid>
            <Name>{66d3cdb4-e3de-40ff-996c-a554674f0fdb}</Name>
            <RegisteredItem>Activity Escalations</RegisteredItem>
          </PropertyWizardDefinition>
          <PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>e4bbc16daf164a7dbe01b6598d550c9e</Guid>
            <Name>{f73e0c14-7db0-46b0-8e05-ac515be236f0}</Name>
            <RegisteredItem>Exception Rule</RegisteredItem>
          </PropertyWizardDefinition>
        </PropertyWizardDefinitions>
        <Guid>458c3f9d3f5a46439c6fc46f41033637</Guid>
        <Name/>
        <Status>Executed</Status>
        <RegisteredItem>Default Activity Wizard</RegisteredItem>
      </WizardDefinition>
      <Guid>5b2076b5df7649ddbbd662c09d31bf21</Guid>
      <Name>DefaultActivity</Name>
      <Slots>1</Slots>
      <Type>SingleInstance</Type>
    </Activity>
  </Activities>
  <StartActivity>
    <Guid>d2a4cc29a092490aa862c782c2805bed</Guid>
    <Name>Start</Name>
    <Type>SingleInstance</Type>
  </StartActivity>
  <Views>
    <ProcessView Type="SourceCode.Workflow.Design.ProcessView" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
      <ActivitiesLayoutData>
        <ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
          <Guid>68280ea48b5241548295c0a3478ef5d8</Guid>
          <Width>190</Width>
          <Height>40</Height>
          <X>200</X>
          <Y>10</Y>
          <Name>{d2a4cc29-a092-490a-a862-c782c2805bed}</Name>
          <MainColorR>166</MainColorR>
          <MainColorG>166</MainColorG>
          <MainColorB>166</MainColorB>
          <ButtonsColorR>1</ButtonsColorR>
          <ButtonsColorG>97</ButtonsColorG>
          <ButtonsColorB>154</ButtonsColorB>
          <SelectionColorR>0</SelectionColorR>
          <SelectionColorG>0</SelectionColorG>
          <SelectionColorB>0</SelectionColorB>
          <IsMinimizedLabelVisible>1</IsMinimizedLabelVisible>
        </ProcessViewActivityLayoutData>
        <ProcessViewActivityLayoutData Type="SourceCode.Workflow.Design.ProcessViewActivityLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
          <EventsLayoutData>
            <ProcessViewEventLayoutData Type="SourceCode.Workflow.Design.ProcessViewEventLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
              <Guid>946f8f705cfa4933a401dc25087becc1</Guid>
              <Name>{3f8acd5e-e28b-4cdb-a158-457334317351}</Name>
            </ProcessViewEventLayoutData>
          </EventsLayoutData>
          <Guid>975e1fe7588c4e6d860788170439938f</Guid>
          <Width>190</Width>
          <Height>38</Height>
          <X>208</X>
          <Y>80</Y>
          <Name>{5b2076b5-df76-49dd-bbd6-62c09d31bf21}</Name>
          <MainColorR>166</MainColorR>
          <MainColorG>166</MainColorG>
          <MainColorB>166</MainColorB>
          <ButtonsColorR>1</ButtonsColorR>
          <ButtonsColorG>97</ButtonsColorG>
          <ButtonsColorB>154</ButtonsColorB>
          <SelectionColorR>0</SelectionColorR>
          <SelectionColorG>0</SelectionColorG>
          <SelectionColorB>0</SelectionColorB>
          <IsEventStripOpen>1</IsEventStripOpen>
          <IsMinimizedLabelVisible>1</IsMinimizedLabelVisible>
        </ProcessViewActivityLayoutData>
      </ActivitiesLayoutData>
      <LinesLayoutData>
        <ProcessViewLineLayoutData Type="SourceCode.Workflow.Design.ProcessViewLineLayoutData" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
          <Guid>da3a8285944545f98685982c08299abb</Guid>
          <StartMaximizedX>92</StartMaximizedX>
          <StartMaximizedY>40</StartMaximizedY>
          <StartMinimizedX>92</StartMinimizedX>
          <StartMinimizedY>40</StartMinimizedY>
          <EndDirectionMaximized>Down</EndDirectionMaximized>
          <EndDirectionMinimized>Down</EndDirectionMinimized>
          <EndMaximizedX>91</EndMaximizedX>
          <EndMaximizedY>46</EndMaximizedY>
          <EndMinimizedX>91</EndMinimizedX>
          <EndMinimizedY>46</EndMinimizedY>
          <LabelLocked>0</LabelLocked>
          <LabelVisible>1</LabelVisible>
          <LabelDragged>0</LabelDragged>
          <LabelLocationX>293</LabelLocationX>
          <LabelLocationY>64</LabelLocationY>
          <LineColorR>26</LineColorR>
          <LineColorG>85</LineColorG>
          <LineColorB>39</LineColorB>
          <LineSelectionColorR>0</LineSelectionColorR>
          <LineSelectionColorG>0</LineSelectionColorG>
          <LineSelectionColorB>0</LineSelectionColorB>
          <LinePinned>0</LinePinned>
          <LineRenderPointCount>4</LineRenderPointCount>
          <LineRenderPointX_0>292</LineRenderPointX_0>
          <LineRenderPointY_0>51</LineRenderPointY_0>
          <LineRenderPointX_1>292</LineRenderPointX_1>
          <LineRenderPointY_1>69</LineRenderPointY_1>
          <LineRenderPointX_2>292</LineRenderPointX_2>
          <LineRenderPointY_2>60</LineRenderPointY_2>
          <LineRenderPointX_3>292</LineRenderPointX_3>
          <LineRenderPointY_3>70</LineRenderPointY_3>
          <Name>{20b66924-e763-47be-a5fe-477091359a23}</Name>
        </ProcessViewLineLayoutData>
      </LinesLayoutData>
      <Guid>4597045cf615466d8cc48eb76ca71023</Guid>
      <Name>ProcessView</Name>
      <GridSizeWidth>16</GridSizeWidth>
      <GridSizeHeight>16</GridSizeHeight>
    </ProcessView>
    <DocumentView Type="SourceCode.Workflow.Design.DocumentView" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
      <Guid>0eb1c25458304b039c90cf5f1d771e85</Guid>
      <Name>DocumentView</Name>
      <ActivitiesHeading>Activities</ActivitiesHeading>
      <ActivitiesHeadingFontData>Arial,12,Bold,None</ActivitiesHeadingFontData>
      <ActivitiesDescription>Activities Section Description</ActivitiesDescription>
      <ActivitiesDescriptionFontData>Arial,12,Bold,None</ActivitiesDescriptionFontData>
      <LinesHeading>Lines</LinesHeading>
      <LinesHeadingFontData>Arial,12,Bold,None</LinesHeadingFontData>
      <LinesDescription>Arial,12,Bold,None</LinesDescription>
      <DataFieldsAreaHeading>Data Fields</DataFieldsAreaHeading>
      <DataFieldsAreaHeadingFontData>Arial,12,Bold,None</DataFieldsAreaHeadingFontData>
      <DataFieldsAreaDescription>Data Fields Section Description</DataFieldsAreaDescription>
      <DataFieldsAreaDescriptionFontData>Arial,12,Bold,None</DataFieldsAreaDescriptionFontData>
      <XMLFieldsAreaHeading>XML Fields</XMLFieldsAreaHeading>
      <XMLFieldsAreaHeadingFontData>Arial,12,Bold,None</XMLFieldsAreaHeadingFontData>
      <XMLFieldsAreaDescription>XML Fields Section Description</XMLFieldsAreaDescription>
      <XMLFieldsAreaDescriptionFontData>Arial,12,Bold,None</XMLFieldsAreaDescriptionFontData>
    </DocumentView>
  </Views>
  <WizardDefinition Type="SourceCode.Workflow.Design.DefaultWizardDefinition" Assembly="SourceCode.Workflow.Authoring, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
    <PropertyWizardDefinitions>
      <PropertyWizardDefinition Type="SourceCode.Workflow.Design.GeneralProperties.GeneralPropertiesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <Guid>f7a9e10629ca4d5ab6564ab7ff8881f3</Guid>
        <Name>{a6c6a5bf-4aab-475a-aa04-4458d931ddb3}</Name>
        <RegisteredItem>Process General Property Wizard</RegisteredItem>
      </PropertyWizardDefinition>
      <PropertyWizardDefinition Type="SourceCode.Workflow.Design.Escalations.EscalationPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <Guid>6413f02b78e644069cca1c66c6530593</Guid>
        <Name>{1803a3ee-527b-44d3-b5ea-c0debab4ca1b}</Name>
        <RegisteredItem>Process Escalations</RegisteredItem>
      </PropertyWizardDefinition>
      <PropertyWizardDefinition Type="SourceCode.Workflow.Design.Exceptions.ExceptionPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <Guid>5958b4bf4a6f476bac0e15cc8f0987f2</Guid>
        <Name>{395f2163-bff3-4f8c-bb0c-5e78f81054ca}</Name>
        <RegisteredItem>Exception Rule</RegisteredItem>
      </PropertyWizardDefinition>
      <PropertyWizardDefinition Type="SourceCode.Workflow.Design.ProcessStartRule.DefaultProcessStartRuleWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <Guid>86fccd38135843af9e6058e4b52457ea</Guid>
        <Name>{3bcbfc7f-059d-416f-b750-6abb327de123}</Name>
        <RegisteredItem>Process Start Rule</RegisteredItem>
      </PropertyWizardDefinition>
      <PropertyWizardDefinition Type="SourceCode.Workflow.Design.ProcessFinishRule.DefaultProcessFinishRuleWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <Guid>ea5362125b3f418faf3ade9fa73438fe</Guid>
        <Name>{51e36a57-30fc-482e-8f21-6e5ece3e5a6a}</Name>
        <RegisteredItem>Process Finish Rule</RegisteredItem>
      </PropertyWizardDefinition>
      <PropertyWizardDefinition Type="SourceCode.Workflow.Design.Associations.AssociationsPropertyDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <SmartObjectServicesDesignerMappings>
          <SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>9af2ebf70690461fbad5dfbff9dc6b68</Guid>
            <DesignerGuid>2f2416dd-449a-49c4-affd-0ed4c2f46b8a</DesignerGuid>
            <WorkflowSmartObjectGuid>0677d77d-a6a8-4624-814f-7d61c869b042</WorkflowSmartObjectGuid>
            <WorkflowReportingSmartObjectGuid>b7129d28-a15d-4df0-be7f-41d6bbf48c7a</WorkflowReportingSmartObjectGuid>
          </SmartObjectServicesDesignerMapping>
          <SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>88e9f6bb644e4f8db8435f8a8b843f50</Guid>
            <DesignerGuid>d2a4cc29-a092-490a-a862-c782c2805bed</DesignerGuid>
            <WorkflowSmartObjectGuid>6efb7f42-33b0-42c1-b65a-65da3652d5a5</WorkflowSmartObjectGuid>
            <WorkflowReportingSmartObjectGuid>23161ed5-db7a-4a78-8f7f-666dc95ce307</WorkflowReportingSmartObjectGuid>
          </SmartObjectServicesDesignerMapping>
          <SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>3d8d1d7885b04080878553cab8da359a</Guid>
            <DesignerGuid>5b2076b5-df76-49dd-bbd6-62c09d31bf21</DesignerGuid>
            <WorkflowSmartObjectGuid>a811165e-6b28-4ec1-9e6a-c31f4462e8a0</WorkflowSmartObjectGuid>
            <WorkflowReportingSmartObjectGuid>91f5da7f-064d-4b0e-bf98-7c3f94020dbc</WorkflowReportingSmartObjectGuid>
          </SmartObjectServicesDesignerMapping>
          <SmartObjectServicesDesignerMapping Type="SourceCode.Workflow.Design.SmartObjectServices.SmartObjectServicesDesignerMapping" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
            <Guid>123c90b42f3a407db25d6e8395a835ea</Guid>
            <DesignerGuid>3f8acd5e-e28b-4cdb-a158-457334317351</DesignerGuid>
            <WorkflowSmartObjectGuid>51c1a03d-744e-4249-92ae-49a3abb39764</WorkflowSmartObjectGuid>
            <WorkflowReportingSmartObjectGuid>b667a8fd-c33d-4e66-a5ba-b2a40a2c875a</WorkflowReportingSmartObjectGuid>
          </SmartObjectServicesDesignerMapping>
        </SmartObjectServicesDesignerMappings>
        <Guid>38a5d5cde0bf47c298e2206aa1da84fb</Guid>
        <Name>{66a3ead7-4d46-4611-a33d-79974662ab08}</Name>
        <RegisteredItem>2124FC5B-E0CF-49D9-8331-DF2B47F2A93E</RegisteredItem>
        <UseSmartObjectServicesDesignerMapping>1</UseSmartObjectServicesDesignerMapping>
      </PropertyWizardDefinition>
      <PropertyWizardDefinition Type="SourceCode.Workflow.Design.References.ProjectReferencesPropertyWizardDefinition" Assembly="SourceCode.Workflow.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=16a2c5aaaa1b130d">
        <Guid>21222a66cef54a128bd387e3ade2a194</Guid>
        <Name>{0fcb89af-0007-4549-8d11-466ebf902744}</Name>
        <RegisteredItem>FDA04D27-504A-4D24-A5BC-854E8CF395E0</RegisteredItem>
      </PropertyWizardDefinition>
    </PropertyWizardDefinitions>
    <Guid>9531123b67fc40cb9e21c24d1ce5fac1</Guid>
    <Name/>
    <Status>Executed</Status>
    <RegisteredItem>Default Process Wizard</RegisteredItem>
  </WizardDefinition>
  <Guid>2f2416dd449a49c4affd0ed4c2f46b8a</Guid>
  <Name>Process</Name>
  <MetaData>Blank</MetaData>
  <ExtenderNamespace>356ce97d8118461788790a9277472edc</ExtenderNamespace>
  <OriginalPath>Process.kprx</OriginalPath>
  <DefaultExecutionLayer>Default</DefaultExecutionLayer>
  <CurrentExecutionLayer>Default</CurrentExecutionLayer>
  <CurrentView>ProcessView</CurrentView>
</Process>
